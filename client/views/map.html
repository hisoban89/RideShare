<!DOCTYPE html>
<html ng-app="userApp"> 
  <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Ride Share</title>
      <meta name="description" content="">
      <meta name="viewport" content="width=device-width, initial-scale=1">

      <link rel="stylesheet" href="/css/bootstrap.css" />
      <link rel="stylesheet" href="/css/style.css" />
    
      <!-- <script src="/js/jquery-2.0.3.min.js"></script> -->
      <!-- <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.3/angular.min.js"></script> -->
      <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

      <link href="/css/iptools-jquery-offcanvas.css" rel="stylesheet" type="text/css">

      <!-- ===================== -->

      <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular.js"></script>
      <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular-resource.js"></script>
      <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDnycWatbGyK6ldFqErjFtko1yeMclNUOA&amp;sensor=true"></script>

      <script type="text/javascript" src="/js/app.js"></script>
      <script type="text/javascript" src="/js/controllers/users-controller.js"></script>
      <script type="text/javascript" src="/js/navigation/navigation-controller.js"></script>
      <!-- ===================== -->

      <!-- ======================= -->

      <!-- <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
      <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
      <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script> -->
      <!-- ======================== -->


      <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 100%;
      }
    </style>




<style>
/* The Modal (background) */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    padding-top: 100px; /* Location of the box */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgb(0,0,0); /* Fallback color */
    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
    background-color: #fefefe;
    margin: auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
}

/* The Close Button */
.close {
    color: #aaaaaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}

.close:hover,
.close:focus {
    color: #000;
    text-decoration: none;
    cursor: pointer;
}
</style>



      
  </head>
  <body ng-controller='usersController'>

  <div class="header clearfix">
    <h4 class="loginHeading">Drivers</h4>

    <!-- Navigation bar -->
    <div class="jquery-script-ads" align="center" style="margin:0px auto;">
      <script type="text/javascript"><!--
        google_ad_client = "ca-pub-2783044520727903";
        /* jQuery_demo */
        google_ad_slot = "2780937993";
        google_ad_width = 728;
        google_ad_height = 90;
        //-->
      </script>
      <!-- <script type="text/javascript"
      src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
      </script> -->
    </div>
    &nbsp&nbsp
    <button class="offcanvas__trigger--open btn" data-offcanvas-open="my-navigation">
      <img src="/images/navigation/nav.png" alt="rideShare" class="img-responsive center-block">
    </button>

    <section id="my-navigation" class="offcanvas">
      <div class="header2 clearfix">
          <img style="float:left" src="/images/navigation/navigation.png" alt="rideShare" class="img-responsive">

          <div>
            <h1 ng-repeat="user in users">
              {{user.fname}}
            </h1>
          </div>
        

          <!-- <h4 class="loginHeading">Username</h4> -->
      </div> <br>

      <table style="width:100%" border="0">
        <tr>
          <td>
            <img style="float:left;margin: 10px;" src="/images/navigation/edit.png" alt="rideShare" class="img-responsive"></td>
          <td align="left"><p>Edit Profile</p></td> 
        </tr>
        <tr>
          <td>
            <img style="float:left;margin: 10px;" src="/images/navigation/history.png" alt="rideShare" class="img-responsive">
          </td>
          <td align="left"><p>History</p></td> 
        </tr>
        <tr>
          <td>
            <img style="float:left;margin: 10px;" src="/images/navigation/settings.png" alt="rideShare" class="img-responsive">
          </td>
          <td align="left"><p>Settings</p></td> 
        </tr>
        <tr>
          <td>
            <img style="float:left;margin: 10px;" src="/images/navigation/help.png" alt="rideShare" class="img-responsive">
          </td>
          <td align="left"><p>Help</p></td> 
        </tr>
        <tr>
          <td>
            <img style="float:left;margin: 10px;" src="/images/navigation/about.png" alt="rideShare" class="img-responsive">
          </td>
          <td align="left"><p>About</p></td> 
        </tr>
        <tr>
          <td><img style="float:left;margin: 10px;" src="/images/navigation/logout.png" alt="rideShare" class="img-responsive" ng-submit=logOut()>
          </td>
          <td align="left">
            <div ng-controller="navigationController">
              <form ng-submit="logOut()">
                <button style="margin-left: -6px;" class="logoutBtn" type="submit"><p class="logout">Logout</p></button>
              </form>
            </div>
          </td> 
        </tr>
        
      </table>


      <br><br>
      <button style="margin-left: -6px;" class="offcanvas__trigger--close btn" data-offcanvas-close="my-navigation">Close</button>
    </section>
    <script src="http://code.jquery.com/jquery-2.2.0.min.js"></script>
    <script src="/css/iptools-jquery-offcanvas.min.js"></script>
      <script>
      $(document).ready(function() {
          $('#my-navigation').iptOffCanvas({
            baseClass: 'offcanvas',
            type: 'left' // top, right, bottom, left.
          });
        });
      </script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-36251023-1']);
      _gaq.push(['_setDomainName', 'jqueryscript.net']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

     
  <!-- End Navigation bar -->

    </div>

    <div class="header2 clearfix">
      <div class="form-group col-xs-6">
        <div class ="myLocationLable">
          <label> My Loation </label>
        </div>
        <input type="text" class="register-input" style="text-align:center;" ng-model="myLocation"></input>
      </div>
      <div class="form-group col-xs-6">
        <div class ="destinationLable">
          <label> Destination </label>
        </div>
        <input type="text" class="register-input" style="text-align:center;" ng-model="destination"></input>
      </div>
    </div>

    <input id="origin-input" class="controls" type="text"
        placeholder="Enter an origin location">

    <input id="destination-input" class="controls" type="text"
        placeholder="Enter a destination location">

    <div id="mode-selector" class="controls">
      <input type="radio" name="type" id="changemode-walking" checked="checked">
      <label for="changemode-walking">Walking</label>

      <input type="radio" name="type" id="changemode-transit">
      <label for="changemode-transit">Transit</label>

      <input type="radio" name="type" id="changemode-driving">
      <label for="changemode-driving">Driving</label>
    </div>


 <!--    <div >
    <h1 id="length">Logged in user length is: {{users.length}}</h1>
        <ul>
          <li ng-repeat="user in users">
            First Name : {{user.fname}}<br>
            Last Name :{{user.lname}}<br>
            User Name: {{user.uname}}<br>
          </li>
        </ul>
    </div> -->


<!-- ======================================= -->

<!-- Trigger/Open The Modal -->
<!-- <button id="myBtn">Open Modal</button> -->

<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <span class="close">Ã—</span>
    <div align="center" >
    <img src="/images/login/userLog_icon.png" alt="rideShare" class="img-responsive center-block">
    <!-- <h1 id="length">Logged in user length is: {{users.length}}</h1> -->
        <ul>
          <li style="list-style-type: none;" ng-repeat="user in users">
            Driver First Name : {{user.fname}}<br>
            Driver Last Name : {{user.lname}}<br>

          </li>
        </ul>
    </div>
    <button type="submit" class="btn btn-warning btn-block">Confirm</button>
  </div>

</div>

<script>

function myFunction() {

  // Get the modal
  var modal = document.getElementById('myModal');

  // Get the button that opens the modal
  var btn = document.getElementById("myBtn");


  // Get the <span> element that closes the modal
  var span = document.getElementsByClassName("close")[0];

  // When the user clicks the button, open the modal
  btn.onclick = function() {
    // alert('sss');
      modal.style.display = "block";
  }

  // When the user clicks on <span> (x), close the modal
  span.onclick = function() {
      modal.style.display = "none";
  }

  // When the user clicks anywhere outside of the modal, close it
  window.onclick = function(event) {
      if (event.target == modal) {
          modal.style.display = "none";
      }
  }

}
</script>











<!-- ======================================= -->



<div id="map"></div>
<!-- <span class="map-icon map-icon-point-of-interest"></span> -->
<script>
  // Note: This example requires that you consent to location sharing when
  // prompted by your browser. If you see the error "The Geolocation service
  // failed.", it means you probably did not give permission for the browser to
  // locate you.
  
  function initMap() {

    var userPosition = {lat: 6.93622529, lng: 79.8800723};

    var locations = [
      ['<div ng-controller="bookingController"><input type="hidden" value="booked" class="register-input" placeholder="Booking" ng-model="booking"></input><button id="myBtn" onclick="myFunction()">Confirm</button></div>', 6.93979, 79.87395 , 4],

      ['Driver Name: bbb<br> phone: 0772222222<br><div ng-controller="bookingController"><form ng-submit="createBooking()" name="myForm"><input type="hidden" value="booked" class="register-input" placeholder="Book" ng-model="booking"></input><button type="submit" class="btn btn-warning btn-block">Confirm</button></form></div>', 6.93960, 79.86827, 5],

      ['Driver Name: ccc<br> phone: 0773333333<br> <div ng-controller="bookingController"><form ng-submit="createBooking()" name="myForm"><input type="hidden" value="booked" class="register-input" placeholder="Book" ng-model="booking"></input><button type="submit" class="btn btn-warning btn-block">Confirm</button></form></div>', 6.93579, 79.88362, 3],

      ['Driver Name: ddd<br> phone: 0774444444<br> <div ng-controller="bookingController"><form ng-submit="createBooking()" name="myForm"><input type="hidden" value="booked" class="register-input" placeholder="Book" ng-model="booking"></input><button type="submit" class="btn btn-warning btn-block">Confirm</button></form></div>', 6.94427, 79.88135, 2],

      ['Driver Name: eee<br> phone: 0775555555<br> <div ng-controller="bookingController"><form ng-submit="createBooking()" name="myForm"><input type="hidden" value="booked" class="register-input" placeholder="Book" ng-model="booking"></input><button type="submit" class="btn btn-warning btn-block">Confirm</button></form></div>', 6.94682, 79.87830, 1]
    ];

    var map = new google.maps.Map(document.getElementById('map'), {
      mapTypeControl: false,
      center : userPosition,
      zoom: 15,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });



// ======  ======================================

 var origin_place_id = null;
        var destination_place_id = null;
        var travel_mode = google.maps.TravelMode.WALKING;


        var directionsService = new google.maps.DirectionsService;
        var directionsDisplay = new google.maps.DirectionsRenderer;
        directionsDisplay.setMap(map);

        var origin_input = document.getElementById('origin-input');
        var destination_input = document.getElementById('destination-input');
        var modes = document.getElementById('mode-selector');

        map.controls[google.maps.ControlPosition.TOP_LEFT].push(origin_input);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(destination_input);
        map.controls[google.maps.ControlPosition.TOP_LEFT].push(modes);

        var origin_autocomplete = new google.maps.places.Autocomplete(origin_input);
        origin_autocomplete.bindTo('bounds', map);
        var destination_autocomplete =
            new google.maps.places.Autocomplete(destination_input);
        destination_autocomplete.bindTo('bounds', map);

        // Sets a listener on a radio button to change the filter type on Places
        // Autocomplete.
        function setupClickListener(id, mode) {
          var radioButton = document.getElementById(id);
          radioButton.addEventListener('click', function() {
            travel_mode = mode;
          });
        }
        setupClickListener('changemode-walking', google.maps.TravelMode.WALKING);
        setupClickListener('changemode-transit', google.maps.TravelMode.TRANSIT);
        setupClickListener('changemode-driving', google.maps.TravelMode.DRIVING);

        function expandViewportToFitPlace(map, place) {
          if (place.geometry.viewport) {
            map.fitBounds(place.geometry.viewport);
          } else {
            map.setCenter(place.geometry.location);
            map.setZoom(17);
          }
        }

        origin_autocomplete.addListener('place_changed', function() {
          var place = origin_autocomplete.getPlace();
          if (!place.geometry) {
            window.alert("Autocomplete's returned place contains no geometry");
            return;
          }
          expandViewportToFitPlace(map, place);

          // If the place has a geometry, store its place ID and route if we have
          // the other place ID
          origin_place_id = place.place_id;
          route(origin_place_id, destination_place_id, travel_mode,
                directionsService, directionsDisplay);
        });

        destination_autocomplete.addListener('place_changed', function() {
          var place = destination_autocomplete.getPlace();
          if (!place.geometry) {
            window.alert("Autocomplete's returned place contains no geometry");
            return;
          }
          expandViewportToFitPlace(map, place);

          // If the place has a geometry, store its place ID and route if we have
          // the other place ID
          destination_place_id = place.place_id;
          route(origin_place_id, destination_place_id, travel_mode,
                directionsService, directionsDisplay);
        });

        function route(origin_place_id, destination_place_id, travel_mode,
                       directionsService, directionsDisplay) {
          if (!origin_place_id || !destination_place_id) {
            return;
          }
          directionsService.route({
            origin: {'placeId': origin_place_id},
            destination: {'placeId': destination_place_id},
            travelMode: travel_mode
          }, function(response, status) {
            if (status === google.maps.DirectionsStatus.OK) {
              directionsDisplay.setDirections(response);
            } else {
              window.alert('Directions request failed due to ' + status);
            }
          });
        }



// ====================================================================================================


    var infoWindow = new google.maps.InfoWindow({map: map});
    //
    var infowindow = new google.maps.InfoWindow();

      var marker, i;

      for (i = 0; i < locations.length; i++) {  
        marker = new google.maps.Marker({
          position: new google.maps.LatLng(locations[i][1], locations[i][2]),
          map: map
        });

        google.maps.event.addListener(marker, 'click', (function(marker, i) {
          return function() {
            infowindow.setContent(locations[i][0]);
            infowindow.open(map, marker);
          }
        })(marker, i));
      }

// =========================================

    // Try HTML5 geolocation.
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(function(position) {
        var pos = {
          lat: position.coords.latitude,
          lng: position.coords.longitude
        };

        var marker = new google.maps.Marker({
        position: pos,
        map: map,
        title: 'View Details'
      });

        //marker.setPosition(pos);
        infoWindow.setPosition(pos);
        infoWindow.setContent('<ul><li ng-repeat="user in users">'+
                                  'Hi {{ user.fname }} !!!<br> Please book your closest vehicle'+
                                '</li>'+
                              '</ul>');
        // map.setCenter(pos);

      }, function() {
        handleLocationError(true, infoWindow, map.getCenter());
      });
    } else {
      // Browser doesn't support Geolocation
      handleLocationError(false, infoWindow, map.getCenter());
    }



  }

  function handleLocationError(browserHasGeolocation, infoWindow, pos) {
    infoWindow.setPosition(pos);
    infoWindow.setContent(browserHasGeolocation ?
                          'Error: The Geolocation service failed.' :
                          'Error: Your browser doesn\'t support geolocation.');
  }




        
      






</script>
<!-- ========================================== -->






<!-- ================================================ -->





<!-- hiso virtusa -->
<!--     <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCh_zPivIBegT1ll2UjT1zacc4zpDMSEYs&callback=initMap">
    </script>
 -->
<!-- hiso mob -->
    <!-- <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBek2QKJkAxIhJ6AHP1Mu0hMa_lGpN-mkg&callback=initMap">
    </script> -->

     <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBek2QKJkAxIhJ6AHP1Mu0hMa_lGpN-mkg&libraries=places&callback=initMap"
        async defer></script>


<!-- Asha Jayakody: -->
    <!-- <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDiC1RjhWDH1dOnSh4VLWrATO4yRuvhN1Y&callback=initMap">
    </script> -->

    

      <!-- <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular.js"></script>
      <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular-resource.js"></script>
      <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDnycWatbGyK6ldFqErjFtko1yeMclNUOA&amp;sensor=true"></script>

      <script type="text/javascript" src="/js/app.js"></script>
      <script type="text/javascript" src="/js/controllers/users-controller.js"></script>
      <script type="text/javascript" src="/js/navigation/navigation-controller.js"></script> -->

  </body>
</html>

<!-- https://ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular.min.js -->